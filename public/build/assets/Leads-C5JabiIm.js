import{_ as me,a as Q,L as ve}from"./GroupedSelect.vue_vue_type_script_setup_true_lang-Drq5abIC.js";import{_ as pe,b as E,h as _e,a as ge}from"./TablePaginationAjax.vue_vue_type_script_setup_true_lang-C9FXpkJu.js";import{a as Se,_ as R}from"./index-Bl7ULf9p.js";import{_ as z}from"./Input.vue_vue_type_script_setup_true_lang-DRq4L5js.js";import{_ as S}from"./Label.vue_vue_type_script_setup_true_lang-C1s4DYKS.js";import{_ as M,a as P,b as B,c as j,d as we,e as N}from"./SelectContent.vue_vue_type_script_setup_true_lang-diDvTw5A.js";import{_ as ye,a as ke,b as G,c as v,d as be,e as p}from"./TableHeader.vue_vue_type_script_setup_true_lang-C-y_m1x9.js";import{g as O}from"./users-BtwOUv08.js";import{u as he}from"./leads-80jE1Bc1.js";import{_ as xe,t as $e}from"./AppLayout.vue_vue_type_script_setup_true_lang-DB6ZMh0f.js";import{d as Le,n as Ve,y as o,l as Ue,g as _,o as i,w as s,b as f,e as l,u,P as Ie,f as n,a as m,h as H,F as w,r as y,t as c,C as Ae}from"./app-DDH9-M8F.js";import{_ as Ce}from"./ImportLeads.vue_vue_type_script_setup_true_lang-CUZNfKaU.js";import{_ as Me}from"./SubmissionAlert.vue_vue_type_script_setup_true_lang-CEAN8wGM.js";import{C as Pe}from"./circle-plus-214mwmPS.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-nlN60pnD.js";import"./useForwardPropsEmits-DhJmBs81.js";import"./useForwardExpose-fh6Ok7He.js";import"./x-CmkwNOn8.js";import"./RovingFocusGroup-B1ONIDe3.js";import"./check-CzJqFMvt.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DpgiMkX7.js";import"./Alert.vue_vue_type_script_setup_true_lang-BDlI-3JF.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=Se("SquarePlusIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),je={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Ne={class:"grid grid-cols-5 gap-2"},Te={class:"w-full"},Fe={key:0,class:"w-full space-y-3"},qe={class:"w-full"},Ee={class:"w-full"},Oe={class:"w-full"},Je={class:"w-full"},Xe={class:"w-full"},De={class:"flex justify-center space-x-1"},Qe={class:"w-full rounded-lg border"},Re={class:"list-disc"},ze={class:"flex w-full justify-center"},Ge={class:"w-full max-w-[14rem]"},Sa=Le({__name:"Leads",setup(He){var D;const k=Ve(),d=o((D=k==null?void 0:k.props)==null?void 0:D.leads),x=o(k.props.leadStatuses),K=o({}),T=o(!1),F=o({}),$=o("off"),J=o([]),q=o([]),L=o([]),b=o([]),r=o([]),g=o(null),V=o(null),U=o(null),I=o(null),A=o(null),h=o({isShow:null,message:null}),W=()=>{const t={};x.value.forEach(e=>{const a=e.group||"Ungrouped";t[a]||(t[a]=[]),t[a].push(e)}),K.value=t};Ue(()=>{J.value=k.props.managers||[],W()});const Y=t=>{r.value?r.value.includes(t)||(r.value=[...r.value,t]):r.value=[t]},Z=t=>{r.value&&(r.value=r.value.filter(e=>e!==t),r.value.length===0&&(r.value=[]))},X=t=>r.value.includes(t),ee=t=>{const e=X(t);e?Z(t):e?console.log("unidentified action"):Y(t)},ae=async t=>{const e=x.value.find(a=>a.id==t);g.value=e==null?void 0:e.id},le=async t=>{const e=await O(t);q.value=e,L.value=[],b.value=[]},se=async t=>{const e=await O(t);L.value=e,b.value=[]},te=async t=>{const e=await O(t);b.value=e},ue=async(t,e)=>{F.value[t]=!0,await he(t,e);const a=await E({pagination:d,endpoint:"/admins/leads"});d.value=a,F.value[t]=!1},ne=t=>{const e=t.target.checked;$.value=e?"on":"off"},de=()=>{Ae({lead_ids:r.value,lead_status_id:g.value,manager_id:V.value,supervisor_id:U.value,team_leader_id:I.value,staff_id:A.value,is_unassign:$.value}).submit("post","/admins/leads/bulk-assign-leads",{onSuccess:async function(){d.value=d.value,T.value=!1,r.value=[],g.value=null,V.value=null,U.value=null,I.value=null,A.value=null,q.value=[],L.value=[],b.value=[];const e=await E({pagination:d,endpoint:"/admins/leads"});d.value=e},onError:function(e){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)){$e.error(e[a],{richColors:!0,description:"Please check the form and try again."});break}}})},oe=()=>{h.value.isShow=!0,h.value.message="Leads imported successfully!"},ie=async()=>{const t=await E({pagination:d,endpoint:"/admins/leads"});d.value=t},re=async()=>{const t=await _e({pagination:d,endpoint:"/admins/leads"});t!=null&&(d.value=t)},fe=async()=>{const t=await ge({pagination:d,endpoint:"/admins/leads"});t!=null&&(d.value=t)};return(t,e)=>(i(),_(xe,null,{default:s(()=>[f("div",je,[l(Me,{isShow:h.value.isShow,message:h.value.message},null,8,["isShow","message"]),f("div",Ne,[l(u(Ie),{href:t.route("admins.leads.create")},{default:s(()=>[l(R,{variant:"default",class:"w-full text-white"},{default:s(()=>[l(u(Pe)),e[9]||(e[9]=n("Add Leads "))]),_:1})]),_:1},8,["href"]),l(me,{onSubmit:de,open:T.value,"onUpdate:open":e[5]||(e[5]=a=>T.value=a)},{trigger:s(()=>[l(R,{variant:"secondary",class:"w-full"},{default:s(()=>[l(u(Be)),e[10]||(e[10]=n("Bulk Assign "))]),_:1})]),content:s(()=>[f("div",Te,[l(S,{class:"mb-1"},{default:s(()=>e[11]||(e[11]=[n("Status")])),_:1}),l(Q,{selectedId:g.value,modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),convertable:x.value,placeholder:"Select Lead Status","onUpdate:selectedId":ae},null,8,["selectedId","modelValue","convertable"])]),$.value=="off"?(i(),m("div",Fe,[f("div",qe,[l(S,{class:"mb-1"},{default:s(()=>e[12]||(e[12]=[n("Manager")])),_:1}),l(M,{modelValue:V.value,"onUpdate:modelValue":[e[1]||(e[1]=a=>V.value=a),le]},{default:s(()=>[l(P,{class:"w-full"},{default:s(()=>[l(B,{placeholder:"Select Manager"})]),_:1}),l(j,null,{default:s(()=>[l(we,null,{default:s(()=>[(i(!0),m(w,null,y(J.value,a=>(i(),_(N,{key:a.id,value:a.id},{default:s(()=>[n(c(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),f("div",Ee,[l(S,{class:"mb-1"},{default:s(()=>e[13]||(e[13]=[n("Supervisor")])),_:1}),l(M,{modelValue:U.value,"onUpdate:modelValue":[e[2]||(e[2]=a=>U.value=a),se]},{default:s(()=>[l(P,{class:"w-full"},{default:s(()=>[l(B,{placeholder:"Select Supervisor"})]),_:1}),l(j,null,{default:s(()=>[(i(!0),m(w,null,y(q.value,a=>(i(),_(N,{key:a.id,value:a.id},{default:s(()=>[n(c(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),f("div",Oe,[l(S,{class:"mb-1"},{default:s(()=>e[14]||(e[14]=[n("Team Leader")])),_:1}),l(M,{modelValue:I.value,"onUpdate:modelValue":[e[3]||(e[3]=a=>I.value=a),te]},{default:s(()=>[l(P,{class:"w-full"},{default:s(()=>[l(B,{placeholder:"Select Team Leader"})]),_:1}),l(j,null,{default:s(()=>[(i(!0),m(w,null,y(L.value,a=>(i(),_(N,{key:a.id,value:a.id},{default:s(()=>[n(c(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),f("div",Je,[l(S,{class:"mb-1"},{default:s(()=>e[15]||(e[15]=[n("Staff")])),_:1}),l(M,{modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=a=>A.value=a)},{default:s(()=>[l(P,{class:"w-full"},{default:s(()=>[l(B,{placeholder:"Select Staff"})]),_:1}),l(j,null,{default:s(()=>[(i(!0),m(w,null,y(b.value,a=>(i(),_(N,{key:a.id,value:a.id},{default:s(()=>[n(c(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])])):H("",!0),f("div",Xe,[f("div",De,[l(z,{id:"unassign",type:"checkbox",class:"w-[1rem]",onClick:ne,checked:$.value=="on"},null,8,["checked"]),l(S,{for:"unassign"},{default:s(()=>e[16]||(e[16]=[n(" Unassign ")])),_:1})])])]),_:1},8,["open"]),l(Ce,{"submission-alert":h.value,"onUpdate:alert":oe,onSubmissionSuccess:ie},null,8,["submission-alert"])]),f("div",Qe,[l(u(ye),{class:"w-full"},{default:s(()=>[l(u(ke),{class:"text-[12pt]"},{default:s(()=>[l(u(G),{class:"bg-[#F5F5F4] dark:bg-[#1C1C1A]"},{default:s(()=>[l(u(v),null,{default:s(()=>e[17]||(e[17]=[n("#")])),_:1}),l(u(v),null,{default:s(()=>e[18]||(e[18]=[n("Name")])),_:1}),l(u(v),null,{default:s(()=>e[19]||(e[19]=[n("Mobile")])),_:1}),l(u(v),null,{default:s(()=>e[20]||(e[20]=[n("Email")])),_:1}),l(u(v),null,{default:s(()=>e[21]||(e[21]=[n("Status")])),_:1}),l(u(v),null,{default:s(()=>e[22]||(e[22]=[n("Ownership")])),_:1}),l(u(v),null,{default:s(()=>e[23]||(e[23]=[n("Assignees")])),_:1})]),_:1})]),_:1}),l(u(be),null,{default:s(()=>[(i(!0),m(w,null,y(d.value.data,a=>(i(),_(u(G),{key:a==null?void 0:a.id},{default:s(()=>[l(u(p),null,{default:s(()=>[l(z,{type:"checkbox",onClick:C=>ee(a.id),checked:X(a.id)},null,8,["onClick","checked"])]),_:2},1024),l(u(p),null,{default:s(()=>[n(c(a.name),1)]),_:2},1024),l(u(p),null,{default:s(()=>[n(c(a.mobile_number),1)]),_:2},1024),l(u(p),null,{default:s(()=>[n(c(a.email),1)]),_:2},1024),l(u(p),null,{default:s(()=>[l(Q,{selectedId:a.lead_status_id,placeholder:"Select lead status",convertable:x.value,"onUpdate:selectedId":C=>ue(a.id,C)},null,8,["selectedId","convertable","onUpdate:selectedId"]),F.value[a.id]?(i(),_(u(ve),{key:0,class:"animate-spin"})):H("",!0)]),_:2},1024),l(u(p),null,{default:s(()=>[n(c(a.is_private?"owned by the staff":"owned by admin"),1)]),_:2},1024),l(u(p),null,{default:s(()=>[f("ul",Re,[(i(!0),m(w,null,y(a.users,(C,ce)=>(i(),m("li",{key:ce},c(C.name),1))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),f("div",ze,[f("div",Ge,[l(pe,{current_page:d.value.current_page,last_page:d.value.last_page,per_page:d.value.per_page,next:re,prev:fe,"onUpdate:current_page":e[6]||(e[6]=a=>d.value.current_page=a),"onUpdate:per_page":e[7]||(e[7]=a=>d.value.per_page=a),"onUpdate:last_page":e[8]||(e[8]=a=>d.value.last_page=a)},null,8,["current_page","last_page","per_page"])])])])])]),_:1}))}});export{Sa as default};
